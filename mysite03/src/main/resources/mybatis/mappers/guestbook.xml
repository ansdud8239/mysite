<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="guestbook">

	<insert id="insert" parameterType="com.douzone.mysite.vo.UserVo">
		<![CDATA[
		insert
		into user 
		values(null,#{name },#{email },password(#{password }),#{gender },now())		
		]]>
	</insert>

	<select id="findByEmailAndPassword"
		resultType="com.douzone.mysite.vo.UserVo" parameterType="map">	
		<![CDATA[
		select no,name 
		from user 
		where email=#{e } and password = password(#{p})	
		]]>
	</select>

	<select id="findByNo" resultType="com.douzone.mysite.vo.UserVo"
		parameterType="long">	
		<![CDATA[
		select name,password,email,gender 
		from user where no=#{no }
		]]>
	</select>

	<update id="update" parameterType="com.douzone.mysite.vo.UserVo">
		<choose>
			<when test='password=""'>
				<![CDATA[
				update user 
				set name=#{name },email=#{email },gender=#{gender } 
				where no=#{no }
				]]>
			</when>
			<otherwise>
				<![CDATA[
				update user 
				set name=#{name },email=#{email },gender=#{gender } 
				where no=#{no }
				]]>
			</otherwise>
		</choose>
	</update>

</mapper>
